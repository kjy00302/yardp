#!/usr/bin/python

# Formats payload to HID Keyboard sequences. Real rough poc for testing basic payloads.
dict_singlekey = {
	# Symbols 
	"\x27": r"\x34",#<'>
	"\x2c": r"\x36",#<,>
	"\x2d": r"\x2d",#<->
	"\x2e": r"\x37",#<.>
	"\x2f": r"\x38",#</>
	# Numbers
	"\x30": r"\x27",#<0>
	"\x31": r"\x1e",#<1>
	"\x32": r"\x1f",#<2>
	"\x33": r"\x20",#<3>
	"\x34": r"\x21",#<4>
	"\x35": r"\x22",#<5>
	"\x36": r"\x23",#<6>
	"\x37": r"\x24",#<7>
	"\x38": r"\x25",#<8>
	"\x39": r"\x26",#<9>
	# Symbols
	"\x3b": r"\x33",#<;>
	"\x3d": r"\x2e",#<=>
	"\x5b": r"\x2f",#<[>
	"\x5c": r"\x31",#<\>
	"\x5d": r"\x30",#<]>
	"\x5f": r"\x2d",#<_>
	"\x60": r"\x35",#<`>
	# Lowercase
	"\x61": r"\x04",#<a>
	"\x62": r"\x05",#<b>
	"\x63": r"\x06",#<c>
	"\x64": r"\x07",#<d>
	"\x65": r"\x08",#<e>
	"\x66": r"\x09",#<f>
	"\x67": r"\x0a",#<g>
	"\x68": r"\x0b",#<h>
	"\x69": r"\x0c",#<i>
	"\x6a": r"\x0d",#<j>
	"\x6b": r"\x0e",#<k>
	"\x6c": r"\x0f",#<l>
	"\x6d": r"\x10",#<m>
	"\x6e": r"\x11",#<n>
	"\x6f": r"\x12",#<o>
	"\x70": r"\x13",#<p>
	"\x71": r"\x14",#<q>
	"\x72": r"\x15",#<r>
	"\x73": r"\x16",#<s>
	"\x74": r"\x17",#<t>
	"\x75": r"\x18",#<u>
	"\x76": r"\x19",#<v>
	"\x77": r"\x1a",#<w>
	"\x78": r"\x1b",#<x>
	"\x79": r"\x1c",#<y>
	"\x7a": r"\x1d",#<z>
	"ENTER":  r"\x28",
        "MENU":  r"\x65",
        "APP":  r"\x65",
        "DOWN":  r"\x51",
        "DOWNARROW":  r"\x51",
        "LEFT":  r"\x50",
        "LEFTARROW":  r"\x50",
        "RIGHT":  r"\x4f",
        "RIGHTARROW":  r"\x4f",
        "UP":  r"\x52",
        "UPARROW":  r"\x52",
        "BREAK":  r"\x48",
        "PAUSE":  r"\x48",
        "CAPSLOCK":  r"\x39",
        "DELETE":  r"\x2a",
        "END":  r"\x4d",
        "ESC":  r"\x29",
        "ESCAPE":  r"\x29",
        "HOME":  r"\x4a",
        "INSERT":  r"\x49",
        "NUMLOCK":  r"\x53",
        "PAGEUP":  r"\x4b",
        "PAGEDOWN":  r"\x4e",
        "PRINTSCREEN":  r"\x46",
        "SCROLLLOCK":  r"\x47",
        "SPACE":  r"\x2c",
        "TAB":  r"\x2b",
	"F1":  r"\x3a",
	"F2":  r"\x3b",
	"F3":  r"\x3c",
	"F4":  r"\x3d",
	"F5":  r"\x3e",
	"F6":  r"\x3f",
	"F7":  r"\x40",
	"F8":  r"\x41",
	"F9":  r"\x42",
	"F10":  r"\x43",
	"F11":  r"\x44",
	"F12":  r"\x45"
}
dict_us = {
	# Symbols 
	"\x20": r"\x00\x00\x00\x2c\x00\x00\x00\x00",#<space>
	"\x21": r"\x20\x00\x00\x1e\x00\x00\x00\x00",#<!>(1+SHIFT)
	"\x22": r"\x20\x00\x00\x34\x00\x00\x00\x00",#<">('+SHIFT)
	"\x23": r"\x20\x00\x00\x20\x00\x00\x00\x00",#<#>(3+SHIFT)
	"\x24": r"\x20\x00\x00\x21\x00\x00\x00\x00",#<$>(4+SHIFT)
	"\x25": r"\x20\x00\x00\x22\x00\x00\x00\x00",#<%>(5+SHIFT)
	"\x26": r"\x20\x00\x00\x24\x00\x00\x00\x00",#<&>(7+SHIFT)
	"\x27": r"\x00\x00\x00\x34\x00\x00\x00\x00",#<'>
	"\x28": r"\x20\x00\x00\x26\x00\x00\x00\x00",#<(>(9+SHIFT)
	"\x29": r"\x20\x00\x00\x27\x00\x00\x00\x00",#<)>(0+SHIFT)
	"\x2a": r"\x20\x00\x00\x25\x00\x00\x00\x00",#<*>(8+SHIFT)
	"\x2b": r"\x20\x00\x00\x2e\x00\x00\x00\x00",#<+>(=+SHIFT)
	"\x2c": r"\x00\x00\x00\x36\x00\x00\x00\x00",#<,>
	"\x2d": r"\x00\x00\x00\x2d\x00\x00\x00\x00",#<->
	"\x2e": r"\x00\x00\x00\x37\x00\x00\x00\x00",#<.>
	"\x2f": r"\x00\x00\x00\x38\x00\x00\x00\x00",#</>
	# Numbers
	"\x30": r"\x00\x00\x00\x27\x00\x00\x00\x00",#<0>
	"\x31": r"\x00\x00\x00\x1e\x00\x00\x00\x00",#<1>
	"\x32": r"\x00\x00\x00\x1f\x00\x00\x00\x00",#<2>
	"\x33": r"\x00\x00\x00\x20\x00\x00\x00\x00",#<3>
	"\x34": r"\x00\x00\x00\x21\x00\x00\x00\x00",#<4>
	"\x35": r"\x00\x00\x00\x22\x00\x00\x00\x00",#<5>
	"\x36": r"\x00\x00\x00\x23\x00\x00\x00\x00",#<6>
	"\x37": r"\x00\x00\x00\x24\x00\x00\x00\x00",#<7>
	"\x38": r"\x00\x00\x00\x25\x00\x00\x00\x00",#<8>
	"\x39": r"\x00\x00\x00\x26\x00\x00\x00\x00",#<9>
	# Symbols
	"\x3a": r"\x20\x00\x00\x33\x00\x00\x00\x00",#<:>(;+SHIFT)
	"\x3b": r"\x00\x00\x00\x33\x00\x00\x00\x00",#<;>
	"\x3c": r"\x20\x00\x00\x36\x00\x00\x00\x00",#<<>(,+SHIFT)
	"\x3d": r"\x00\x00\x00\x2e\x00\x00\x00\x00",#<=>
	"\x3e": r"\x20\x00\x00\x37\x00\x00\x00\x00",#<>>(.+SHIFT)
	"\x3f": r"\x20\x00\x00\x38\x00\x00\x00\x00",#<?>(/+SHIFT)
	"\x40": r"\x20\x00\x00\x1f\x00\x00\x00\x00",#<@>(2+SHIFT)
	# Uppercase
	"\x41": r"\x20\x00\x00\x04\x00\x00\x00\x00",#<A>(a+SHIFT)
	"\x42": r"\x20\x00\x00\x05\x00\x00\x00\x00",#<B>(b+SHIFT)
	"\x43": r"\x20\x00\x00\x06\x00\x00\x00\x00",#<C>(c+SHIFT)
	"\x44": r"\x20\x00\x00\x07\x00\x00\x00\x00",#<D>(d+SHIFT)
	"\x45": r"\x20\x00\x00\x08\x00\x00\x00\x00",#<E>(e+SHIFT)
	"\x46": r"\x20\x00\x00\x09\x00\x00\x00\x00",#<F>(f+SHIFT)
	"\x47": r"\x20\x00\x00\x0a\x00\x00\x00\x00",#<G>(g+SHIFT)
	"\x48": r"\x20\x00\x00\x0b\x00\x00\x00\x00",#<H>(h+SHIFT)
	"\x49": r"\x20\x00\x00\x0c\x00\x00\x00\x00",#<I>(i+SHIFT)
	"\x4a": r"\x20\x00\x00\x0d\x00\x00\x00\x00",#<J>(j+SHIFT)
	"\x4b": r"\x20\x00\x00\x0e\x00\x00\x00\x00",#<K>(k+SHIFT)
	"\x4c": r"\x20\x00\x00\x0f\x00\x00\x00\x00",#<L>(l+SHIFT)
	"\x4d": r"\x20\x00\x00\x10\x00\x00\x00\x00",#<M>(m+SHIFT)
	"\x4e": r"\x20\x00\x00\x11\x00\x00\x00\x00",#<N>(n+SHIFT)
	"\x4f": r"\x20\x00\x00\x12\x00\x00\x00\x00",#<O>(o+SHIFT)
	"\x50": r"\x20\x00\x00\x13\x00\x00\x00\x00",#<P>(p+SHIFT)
	"\x51": r"\x20\x00\x00\x14\x00\x00\x00\x00",#<Q>(q+SHIFT)
	"\x52": r"\x20\x00\x00\x15\x00\x00\x00\x00",#<R>(r+SHIFT)
	"\x53": r"\x20\x00\x00\x16\x00\x00\x00\x00",#<S>(s+SHIFT)
	"\x54": r"\x20\x00\x00\x17\x00\x00\x00\x00",#<T>(t+SHIFT)
	"\x55": r"\x20\x00\x00\x18\x00\x00\x00\x00",#<U>(u+SHIFT)
	"\x56": r"\x20\x00\x00\x19\x00\x00\x00\x00",#<V>(v+SHIFT)
	"\x57": r"\x20\x00\x00\x1a\x00\x00\x00\x00",#<W>(w+SHIFT)
	"\x58": r"\x20\x00\x00\x1b\x00\x00\x00\x00",#<X>(x+SHIFT)
	"\x59": r"\x20\x00\x00\x1c\x00\x00\x00\x00",#<Y>(y+SHIFT)
	"\x5a": r"\x20\x00\x00\x1d\x00\x00\x00\x00",#<Z>(z+SHIFT)
	# Symbols
	"\x5b": r"\x00\x00\x00\x2f\x00\x00\x00\x00",#<[>
	"\x5c": r"\x00\x00\x00\x31\x00\x00\x00\x00",#<\>
	"\x5d": r"\x00\x00\x00\x30\x00\x00\x00\x00",#<]>
	"\x5e": r"\x20\x00\x00\x23\x00\x00\x00\x00",#<^>(6+SHIFT)
	"\x5f": r"\x00\x00\x00\x2d\x00\x00\x00\x00",#<_>
	"\x60": r"\x00\x00\x00\x35\x00\x00\x00\x00",#<`>
	# Lowercase
	"\x61": r"\x00\x00\x00\x04\x00\x00\x00\x00",#<a>
	"\x62": r"\x00\x00\x00\x05\x00\x00\x00\x00",#<b>
	"\x63": r"\x00\x00\x00\x06\x00\x00\x00\x00",#<c>
	"\x64": r"\x00\x00\x00\x07\x00\x00\x00\x00",#<d>
	"\x65": r"\x00\x00\x00\x08\x00\x00\x00\x00",#<e>
	"\x66": r"\x00\x00\x00\x09\x00\x00\x00\x00",#<f>
	"\x67": r"\x00\x00\x00\x0a\x00\x00\x00\x00",#<g>
	"\x68": r"\x00\x00\x00\x0b\x00\x00\x00\x00",#<h>
	"\x69": r"\x00\x00\x00\x0c\x00\x00\x00\x00",#<i>
	"\x6a": r"\x00\x00\x00\x0d\x00\x00\x00\x00",#<j>
	"\x6b": r"\x00\x00\x00\x0e\x00\x00\x00\x00",#<k>
	"\x6c": r"\x00\x00\x00\x0f\x00\x00\x00\x00",#<l>
	"\x6d": r"\x00\x00\x00\x10\x00\x00\x00\x00",#<m>
	"\x6e": r"\x00\x00\x00\x11\x00\x00\x00\x00",#<n>
	"\x6f": r"\x00\x00\x00\x12\x00\x00\x00\x00",#<o>
	"\x70": r"\x00\x00\x00\x13\x00\x00\x00\x00",#<p>
	"\x71": r"\x00\x00\x00\x14\x00\x00\x00\x00",#<q>
	"\x72": r"\x00\x00\x00\x15\x00\x00\x00\x00",#<r>
	"\x73": r"\x00\x00\x00\x16\x00\x00\x00\x00",#<s>
	"\x74": r"\x00\x00\x00\x17\x00\x00\x00\x00",#<t>
	"\x75": r"\x00\x00\x00\x18\x00\x00\x00\x00",#<u>
	"\x76": r"\x00\x00\x00\x19\x00\x00\x00\x00",#<v>
	"\x77": r"\x00\x00\x00\x1a\x00\x00\x00\x00",#<w>
	"\x78": r"\x00\x00\x00\x1b\x00\x00\x00\x00",#<x>
	"\x79": r"\x00\x00\x00\x1c\x00\x00\x00\x00",#<y>
	"\x7a": r"\x00\x00\x00\x1d\x00\x00\x00\x00",#<z>
	#Shift chars
	"\x7b": r"\x20\x00\x00\x2f\x00\x00\x00\x00",#<{>([+SHIFT)
	"\x7c": r"\x20\x00\x00\x31\x00\x00\x00\x00",#<|>(\+SHIFT)
	"\x7d": r"\x20\x00\x00\x30\x00\x00\x00\x00",#<}>(]+SHIFT)
	"\x7e": r"\x20\x00\x00\x35\x00\x00\x00\x00",#<~>(`+SHIFT)
	#SDLK_RETURN,0x28
	"\x0a": r"\x00\x00\x00\x28\x00\x00\x00\x00",
	"\x0d": r"\x00\x00\x00\x28\x00\x00\x00\x00"
}

def findinlist(byte, locale):
	if locale=="us" : return dict_us[byte].decode('string-escape')
	elif locale=="singlekey" : return dict_singlekey[byte].decode('string-escape')
